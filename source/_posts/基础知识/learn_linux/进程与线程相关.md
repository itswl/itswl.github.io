---
title: 进程与线程
date: 2020/04/22 11:05:31
tags:
categories: linux
---


1. CPU，它承担了所有的计算任务，进程是指程序的一次执行，线程是CPU的基本调度单位。
2. 进程的内存空间是共享的，每个线程都可以使用这些共享内存,
3. 一个线程使用某些共享内存时，其他线程必须等它结束，才能使用这一块内存,"互斥锁"（Mutual exclusion，缩写 Mutex），防止多个线程同时读写某一块内存区域
4. "互斥锁"（Mutual exclusion，缩写 Mutex），防止多个线程同时读写某一块内存区域
5. 某些内存区域，只能供给固定数目的线程使用,"信号量"（Semaphore），用来保证多个线程不会互相冲突


## 概念
进程就是操作系统中执行的一个程序，操作系统以进程为单位分配存储空间，每个进程都有自己的地址空间、数据栈以及其他用于跟踪进程执行的辅助数据，操作系统管理所有进程的执行，为它们合理的分配资源。进程可以通过fork或spawn的方式来创建新的进程来执行其他的任务，不过新的进程也有自己独立的内存空间，因此必须通过进程间通信机制（IPC，Inter-Process Communication）来实现数据共享，具体的方式包括管道、信号、套接字、共享内存区等。

一个进程还可以拥有多个并发的执行线索，简单的说就是拥有多个可以获得CPU调度的执行单元，这就是所谓的线程。由于线程在同一个进程下，它们可以共享相同的上下文，因此相对于进程而言，线程间的信息共享和通信更加容易。当然在单核CPU系统中，真正的并发是不可能的，因为在某个时刻能够获得CPU的只有唯一的一个线程，多个线程共享了CPU的执行时间

## 同步与异步
同步： 发出一个功能调用时，在没得到结果前，该调用 不返回或继续执行后续操作
异步： 发出一个功能调用时，在没得到结果前，可以继续执行后续操作。 调用的返回不受控制

异步是目的，多线程是实现这个目的的方法

## 阻塞和非阻塞
阻塞和非阻塞 主要是程序(线程) 等待消息 通知时的状态有关。
阻塞 ： 调用结果没返回前，当前线程被挂起
非阻塞 ：调用不能得到结果前，该调用不会阻塞当前线程

## 并发并行
并发 ：单核cpu 多线程，一个时间段 只有一个线程，其他线程处于挂起状态。多个线程共享了CPU的执行时间
并行 ：多核cpu , 一个cpu 执行一个线程时，另一个cpu同时执行另一个线程。这两个线程间不抢占cpu资源，可同时进行


## 线程
线程 本质上是 进程中一段并发运行的代码，所以 线程需要 操作系统投入 cpu 资源来运行和调度（Python 计算密集型，gil锁，效率反而会低）

多线程优点 ： 依然顺序执行，编程简单
多线程缺点 ： 上下文切换的额外负担、线程间共享变量会出现死锁

## 同步/异步/阻塞/非阻塞
同步阻塞 ：效率低
同步非阻塞 ：需要在两种状态来回切换
异步阻塞 ： 不是处理消息时阻塞，而是等待消息阻塞。不做其他任务处理
异步非阻塞 ：效率高






